{"ast":null,"code":"import _toConsumableArray from \"/home/rohit/radio/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/home/rohit/radio/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/rohit/radio/frontend/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/rohit/radio/frontend/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/rohit/radio/frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/rohit/radio/frontend/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/home/rohit/radio/frontend/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/home/rohit/radio/frontend/src/Components/commonview.js\";\nimport React, { Component } from \"react\";\nimport { Search, Grid } from \"semantic-ui-react\";\nimport ReactPlayer from \"react-player\";\nimport Navbar from \"./navbar\";\nimport Queue from \"./queue.js\";\nimport Chat from \"./chat.js\";\nimport \"./commonview.scss\";\nvar API_key = \"AIzaSyALsePfmVRgtvFqd7eSjBOSM7UL_Ti2YW4\";\n\nvar CommonView =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(CommonView, _Component);\n\n  function CommonView(props) {\n    var _this;\n\n    _classCallCheck(this, CommonView);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(CommonView).call(this, props));\n\n    _this.handleChange = function (event) {\n      _this.setState({\n        query: event.target.value\n      }, function () {\n        var message = _this.state.query;\n        var finalURL = \"https://www.googleapis.com/youtube/v3/search?part=snippet&order=viewCount&q=\".concat(message, \"&type=video&videoDefinition=high&key=\").concat(API_key, \"&maxResults=5\");\n        fetch(finalURL).then(function (response) {\n          return response.json();\n        }).then(function (responseJson) {\n          var searchResults = responseJson.items.map(function (obj) {\n            return {\n              title: obj.snippet.title,\n              description: \"Youtube search\",\n              image: \"https://img.youtube.com/vi/\".concat(obj.id.videoId, \"/default.jpg\"),\n              url: \"https://www.youtube.com/watch?v=\".concat(obj.id.videoId, \"&autoplay=0\")\n            };\n          });\n\n          _this.setState({\n            results: searchResults\n          });\n        });\n      });\n    };\n\n    _this.handleQueue = function (e, _ref) {\n      var result = _ref.result;\n      var queue = _this.state.queue;\n      var new_song = {\n        title: result.title,\n        image: result.image,\n        url: result.url\n      };\n      var isOnTheList = 0;\n\n      for (var i = 0; i < queue.length; i++) {\n        if (queue[i].title === new_song.title) {\n          isOnTheList = 1;\n          break;\n        }\n      }\n\n      if (!isOnTheList) {\n        new_song !== \"\" && _this.setState({\n          queue: [].concat(_toConsumableArray(queue), [new_song])\n        }, function () {\n          _this.setUrl();\n        });\n      }\n    };\n\n    _this.send_data = function (e) {\n      var data = {\n        url: _this.state.url,\n        played: _this.state.played,\n        duration: _this.state.duration,\n        queue: _this.state.queue\n      };\n\n      _this.state.streamSocket.send(JSON.stringify(data));\n    };\n\n    _this.onEnd = function (event) {\n      var array = _toConsumableArray(_this.state.queue);\n\n      var index = array[0];\n      array.splice(index, 1);\n\n      _this.setState({\n        queue: array\n      }, function () {\n        _this.setUrl();\n      });\n    };\n\n    _this.ref = function (player) {\n      _this.player = player;\n    };\n\n    _this.state = {\n      streamSocket: new WebSocket(\"ws://127.0.0.1:8000/ws/stream/\".concat(_this.props.match.params.name, \"/\")),\n      chatSocket: new WebSocket(\"ws://127.0.0.1:8000/ws/chatbox/\".concat(_this.props.match.params.name, \"/\")),\n      url: null,\n      playing: true,\n      volume: 1,\n      muted: false,\n      played: 0,\n      loaded: 0,\n      duration: 0,\n      seeking: 0,\n      queue: []\n    };\n    _this.handleChange = _this.handleChange.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleQueue = _this.handleQueue.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.setUrl = _this.setUrl.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.send_data = _this.send_data.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.onEnd = _this.onEnd.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  } //function responsible for syncing data\n\n\n  _createClass(CommonView, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var streamSocket = this.state.streamSocket;\n      var i = 0;\n\n      streamSocket.onmessage = function (e) {\n        var data = JSON.parse(e.data);\n        console.log(data[\"played\"]);\n\n        _this2.setState({\n          url: data[\"url\"],\n          duration: data[\"duration\"],\n          played: data[\"played\"],\n          queue: data[\"queue\"]\n        }, function () {\n          for (; i < 1; i++) {\n            _this2.player.seekTo(_this2.state.played);\n          }\n        });\n      };\n    } //function responsible for retrieving and mapping search results\n\n  }, {\n    key: \"setUrl\",\n    //function responsible for setting url\n    value: function setUrl() {\n      var _this3 = this;\n\n      this.setState({\n        url: this.state.queue[0].url\n      }, function () {\n        _this3.send_data();\n      });\n    } //function referencing player\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          query = _this$state.query,\n          results = _this$state.results;\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183\n        },\n        __self: this\n      }, React.createElement(Navbar, {\n        name: this.props.match.params.name,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }), \" \"), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        id: \"search\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188\n        },\n        __self: this\n      }, React.createElement(Search, {\n        onSearchChange: this.handleChange,\n        results: results,\n        value: query,\n        onResultSelect: this.handleQueue,\n        style: {\n          width: \"100%\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189\n        },\n        __self: this\n      }), \" \")), React.createElement(\"div\", {\n        id: \"flex-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"VidWrapper\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203\n        },\n        __self: this\n      }, React.createElement(ReactPlayer, {\n        ref: this.ref,\n        url: this.state.url,\n        playing: true,\n        onEnded: this.onEnd,\n        onProgress: this.onProgress,\n        volume: this.state.volume,\n        muted: this.state.muted,\n        height: \"100%\",\n        width: \"100%\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"overlay\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215\n        },\n        __self: this\n      }, \" \"), \" \"), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 218\n        },\n        __self: this\n      }, React.createElement(Chat, {\n        channel: this.props.match.params.name,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 219\n        },\n        __self: this\n      }), \" \"), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222\n        },\n        __self: this\n      }, React.createElement(Queue, {\n        queue: this.state.queue,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223\n        },\n        __self: this\n      }), \" \")));\n    }\n  }]);\n\n  return CommonView;\n}(Component);\n\nexport { CommonView as default };","map":{"version":3,"sources":["/home/rohit/radio/frontend/src/Components/commonview.js"],"names":["React","Component","Search","Grid","ReactPlayer","Navbar","Queue","Chat","API_key","CommonView","props","handleChange","event","setState","query","target","value","message","state","finalURL","fetch","then","response","json","responseJson","searchResults","items","map","obj","title","snippet","description","image","id","videoId","url","results","handleQueue","e","result","queue","new_song","isOnTheList","i","length","setUrl","send_data","data","played","duration","streamSocket","send","JSON","stringify","onEnd","array","index","splice","ref","player","WebSocket","match","params","name","chatSocket","playing","volume","muted","loaded","seeking","bind","onmessage","parse","console","log","seekTo","width","onProgress"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { Search, Grid } from \"semantic-ui-react\";\nimport ReactPlayer from \"react-player\";\nimport Navbar from \"./navbar\";\nimport Queue from \"./queue.js\";\nimport Chat from \"./chat.js\";\nimport \"./commonview.scss\"\n\nconst API_key = \"AIzaSyALsePfmVRgtvFqd7eSjBOSM7UL_Ti2YW4\";\n\nexport default class CommonView extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      streamSocket: new WebSocket(\n        `ws://127.0.0.1:8000/ws/stream/${this.props.match.params.name}/`,\n      ),\n      chatSocket: new WebSocket(\n        `ws://127.0.0.1:8000/ws/chatbox/${this.props.match.params.name}/`,\n      ),\n      url: null,\n      playing: true,\n      volume: 1,\n      muted: false,\n      played: 0,\n      loaded: 0,\n      duration: 0,\n      seeking: 0,\n      queue: [],\n    };\n\n    this.handleChange = this.handleChange.bind(this);\n    this.handleQueue = this.handleQueue.bind(this);\n    this.setUrl = this.setUrl.bind(this);\n\n    this.send_data = this.send_data.bind(this);\n\n    this.onEnd = this.onEnd.bind(this);\n  }\n\n  //function responsible for syncing data\n\n  componentDidMount() {\n    const streamSocket = this.state.streamSocket;\n    let i = 0;\n    streamSocket.onmessage = e => {\n      let data = JSON.parse(e.data);\n      console.log(data[\"played\"]);\n      this.setState(\n        {\n          url: data[\"url\"],\n          duration: data[\"duration\"],\n          played: data[\"played\"],\n          queue: data[\"queue\"],\n        },\n        () => {\n          for (; i < 1; i++) {\n            this.player.seekTo(this.state.played);\n          }\n        },\n      );\n    };\n  }\n\n  //function responsible for retrieving and mapping search results\n\n  handleChange = event => {\n    this.setState(\n      {\n        query: event.target.value,\n      },\n      () => {\n        var message = this.state.query;\n        var finalURL = `https://www.googleapis.com/youtube/v3/search?part=snippet&order=viewCount&q=${message}&type=video&videoDefinition=high&key=${API_key}&maxResults=5`;\n\n        fetch(finalURL)\n          .then(response => response.json())\n          .then(responseJson => {\n            const searchResults = responseJson.items.map(obj => ({\n              title: obj.snippet.title,\n              description: \"Youtube search\",\n              image: `https://img.youtube.com/vi/${obj.id.videoId}/default.jpg`,\n              url: `https://www.youtube.com/watch?v=${\n                obj.id.videoId\n              }&autoplay=0`,\n            }));\n\n            this.setState({\n              results: searchResults,\n            });\n          });\n      },\n    );\n  };\n\n  //function responsible for queueing\n\n  handleQueue = (e, { result }) => {\n    let queue = this.state.queue;\n\n    const new_song = {\n      title: result.title,\n      image: result.image,\n      url: result.url,\n    };\n\n    let isOnTheList = 0;\n\n    for (var i = 0; i < queue.length; i++) {\n      if (queue[i].title === new_song.title) {\n        isOnTheList = 1;\n        break;\n      }\n    }\n\n    if (!isOnTheList) {\n      new_song !== \"\" &&\n        this.setState(\n          {\n            queue: [...queue, new_song],\n          },\n          () => {\n            this.setUrl();\n          },\n        );\n    }\n  };\n\n  //function responsible for sending data\n\n  send_data = e => {\n    let data = {\n      url: this.state.url,\n      played: this.state.played,\n      duration: this.state.duration,\n      queue: this.state.queue,\n    };\n    this.state.streamSocket.send(JSON.stringify(data));\n  };\n\n  //function responsible for handling song end\n\n  onEnd = event => {\n    let array = [...this.state.queue];\n    let index = array[0];\n    array.splice(index, 1);\n\n    this.setState(\n      {\n        queue: array,\n      },\n      () => {\n        this.setUrl();\n      },\n    );\n  };\n\n  //function responsible for setting url\n\n  setUrl() {\n    this.setState(\n      {\n        url: this.state.queue[0].url,\n      },\n      () => {\n        this.send_data();\n      },\n    );\n  }\n\n  //function referencing player\n\n  ref = player => {\n    this.player = player;\n  };\n\n  render() {\n    const { query, results } = this.state;\n\n    return (\n      <div>\n        <div>\n          <Navbar name={this.props.match.params.name} />{\" \"}\n        </div>\n\n        <div>\n          <div id=\"search\">\n            <Search\n               \n              onSearchChange={this.handleChange}\n              results={results}\n              value={query}\n              onResultSelect={this.handleQueue}\n              style={{\n                width: \"100%\",\n              }}\n            />{\" \"}\n          </div>\n        </div>\n\n        <div id=\"flex-container\">\n          <div className=\"VidWrapper\">\n            <ReactPlayer\n              ref={this.ref}\n              url={this.state.url}\n              playing\n              onEnded={this.onEnd}\n              onProgress={this.onProgress}\n              volume={this.state.volume}\n              muted={this.state.muted}\n              height=\"100%\"\n              width=\"100%\"\n            />\n            <div className=\"overlay\"> </div>{\" \"}\n          </div>\n\n          <div>\n            <Chat channel={this.props.match.params.name} />{\" \"}\n          </div>\n\n          <div>\n            <Queue queue={this.state.queue} />{\" \"}\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}